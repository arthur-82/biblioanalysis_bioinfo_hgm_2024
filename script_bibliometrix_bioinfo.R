# Script bibliometrix Artigo Bioinformatics
# 07/06/2023



### PASSO 1 - Instale os pacotes necessários clicando RUN ou CTRL + R na linha desejada
install.packages("bibliometrix")
install.packages("tidygraph")
install.packages("ggraph")
install.packages("sparkline")



### PASSO 2 - Carregue os pacotes necessários clicando RUN ou CTRL + R na linha desejada
library(bibliometrix)
library(dplyr)
library(tidyverse)
library(stringr)
library(tidygraph)
library(ggraph)
library(sparkline)

### PASSO 3 - Defina o diretório de trabalho informando a pasta onde foram salvos os resultados
# das buscas realizadas nas bases de dados. É aconselhável criar uma pasta específica
setwd("C:/Users/limas/OneDrive/Área de Trabalho/Documentos de Estudo/Escritos acadêmicos/4. artigo_bioinfo/")

# Conferindo o diretório de trabalho
getwd()





#######################################################
# Carregando os arquivos
scopus <- convert2df("bioinfo2/bibliometrix2/scopus.csv", dbsource = "scopus", format = "csv")
wos <- convert2df("bioinfo2/bibliometrix2/savedrecs.txt", dbsource = "wos", format = "plaintext")
pubmed <- convert2df("bioinfo2/bibliometrix2/pubmed-gastrointe-set.txt", dbsource = "pubmed", format = "plaintext")

# OBS.: Confira se os arquivos criados contem as mesmas quantidades de artigos
# que as bases de dados retornaram

### Unindo os bancos de dados, excluindo as duplicatas
M <- mergeDbSources(scopus, wos, pubmed, remove.duplicated = TRUE)

### Lista de trabalhos duplicados (3, além dos 186 identificados pelo bibliometrix)
M_duplicatas <- c(1319, 1335, 1331)

### Lista de trabalhos fora da lista (33)
M_fora_lista <- c(1363, 1342, 1347, 1351, 1377, 1368, 1350, 1378, 1316, 1344,
                  1365, 1373, 1356, 1367, 1371, 1357, 1380, 1352, 1374, 1376,
                  1364, 1355, 1379, 1381, 1369, 1353, 1359, 1349, 818, 1346,
                  1345, 1370, 1375)

### Lista de trabalhos excluídos (559)
M_exc <- c(1297, 457, 277, 733, 1273, 1223, 518, 582, 975, 1309, 604, 1051, 1060, 62, 997, 115, 195, 114, 695, 1249,
  358, 922, 271, 1107, 771, 443, 227, 276, 870, 928, 838, 3, 72, 1140, 688, 943, 419, 885, 399, 484, 947, 1167,
  2, 1156, 1310, 192, 763, 857, 872, 946, 1158, 782, 497, 819, 297, 1001, 1003, 1303, 132, 232, 432, 149, 802,
  265, 950, 231, 729, 48, 859, 251, 169, 999, 1317, 1090, 189, 240, 508, 81, 1109, 1175, 803, 1266, 1173, 352,
  218, 939, 372, 701, 1008, 198, 26, 1118, 822, 1305, 543, 1211, 1187, 1260, 693, 716, 90, 99, 1256, 882, 689,
  1091, 741, 1217, 1210, 1147, 987, 891, 440, 1185, 289, 1268, 821, 170, 487, 657, 175, 145, 285, 938, 274, 1093,
  513, 1196, 1050, 391, 40, 480, 1180, 744, 104, 1209, 27, 683, 854, 884, 899, 438, 448, 667, 344, 575, 549, 311,
  619, 1302, 1300, 248, 389, 33, 172, 30, 268, 1133, 316, 1372, 1227, 234, 566, 186, 830, 1124, 416, 1250, 298,
  489, 357, 219, 155, 402, 52, 1182, 1270, 533, 304, 424, 319, 965, 696, 105, 14, 60, 1325, 88, 1143, 77, 32, 43,
  544, 71, 89, 580, 147, 1041, 1314, 78, 790, 1010, 708, 886, 1104, 564, 1011, 644, 531, 726, 1098, 900, 1322, 1116,
  225, 610, 1005, 1308, 148, 920, 956, 1343, 668, 383, 342, 1004, 1230, 18, 1197, 753, 627, 1111, 441, 625, 839, 1031,
  207, 335, 596, 697, 576, 1078, 990, 322, 85, 986, 279, 996, 434, 515, 66, 28, 1132, 326, 257, 313, 918, 56, 226,
  1283, 1280, 286, 390, 977, 836, 540, 1240, 220, 1172, 856, 1214, 760, 460, 814, 924, 59, 713, 868, 914, 919, 587,
  1113, 1029, 1234, 703, 1018, 397, 1366, 656, 284, 1095, 1301, 1318, 260, 1295, 536, 459, 879, 1043, 1142, 488, 784,
  44, 73, 1358, 756, 1252, 190, 985, 620, 111, 1315, 980, 626, 1188, 394, 1286, 338, 848, 39, 734, 1225, 174, 1244,
  9, 1134, 249, 648, 46, 1324, 1135, 157, 851, 778, 915, 409, 1179, 834, 654, 796, 962, 1028, 1141, 1282, 191, 1259,
  25, 910, 994, 1261, 1212, 746, 1127, 931, 558, 1122, 976, 107, 698, 146, 1144, 548, 906, 19, 514, 628, 100, 185,
  1181, 1152, 537, 1070, 829, 517, 635, 444, 368, 181, 458, 449, 761, 525, 1291, 70, 532, 538, 84, 600, 740, 204,
  1298, 138, 1293, 1191, 692, 1054, 933, 130, 1081, 1048, 958, 94, 1306, 1323, 341, 893, 318, 835, 96, 1222, 828,
  1149, 301, 1245, 1255, 592, 1231, 1176, 622, 273, 1137, 1139, 125, 785, 1123, 704, 20, 608, 1313, 673, 921, 327,
  347, 61, 7, 482, 1328, 1131, 87, 1155, 310, 1042, 650, 646, 852, 194, 1027, 263, 1085, 1159, 1221, 551, 1329, 392,
  417, 738, 897, 119, 1151, 904, 349, 722, 629, 95, 388, 1053, 935, 973, 880, 423, 776, 1115, 542, 485, 106, 617,
  1348, 660, 498, 1105, 942, 647, 452, 982, 272, 307, 122, 529, 799, 812, 577, 1284, 786, 491, 774, 612, 1304, 83,
  905, 1336, 206, 334, 788, 24, 1272, 672, 411, 881, 1034, 1195, 1080, 742, 1290, 579, 1312, 963, 477, 239, 1248,
  1274, 754, 772, 1183, 787, 1341, 1013, 535, 894, 783, 941, 702, 903, 534, 991, 1056, 142, 736, 916, 492, 791,
  1326, 136, 1320, 806, 949, 1074, 1096, 864, 117, 69, 237, 64, 15, 1192, 585, 1264, 356, 516, 483)


### Excluindo os trabalhos
M <- M[-c(1319, 1335, 1331, 1363, 1342, 1347, 1351, 1377, 1368, 1350, 1378, 1316, 1344, 1365, 1373, 1356, 1367,
          1371, 1357, 1380, 1352, 1374, 1376, 1364, 1355, 1379, 1381, 1369, 1353, 1359, 1349, 818, 1346, 1345,
          1370, 1375, 1297, 457, 277, 733, 1273, 1223, 518, 582, 975, 1309, 604, 1051, 1060, 62, 997, 115, 195,
          114, 695, 1249, 358, 922, 271, 1107, 771, 443, 227, 276, 870, 928, 838, 3, 72, 1140, 688, 943, 419, 885,
          399, 484, 947, 1167, 2, 1156, 1310, 192, 763, 857, 872, 946, 1158, 782, 497, 819, 297, 1001, 1003, 1303,
          132, 232, 432, 149, 802, 265, 950, 231, 729, 48, 859, 251, 169, 999, 1317, 1090, 189, 240, 508, 81, 1109,
          1175, 803, 1266, 1173, 352, 218, 939, 372, 701, 1008, 198, 26, 1118, 822, 1305, 543, 1211, 1187, 1260, 693,
          716, 90, 99, 1256, 882, 689, 1091, 741, 1217, 1210, 1147, 987, 891, 440, 1185, 289, 1268, 821, 170, 487,
          657, 175, 145, 285, 938, 274, 1093, 513, 1196, 1050, 391, 40, 480, 1180, 744, 104, 1209, 27, 683, 854, 884,
          899, 438, 448, 667, 344, 575, 549, 311, 619, 1302, 1300, 248, 389, 33, 172, 30, 268, 1133, 316, 1372, 1227,
          234, 566, 186, 830, 1124, 416, 1250, 298, 489, 357, 219, 155, 402, 52, 1182, 1270, 533, 304, 424, 319, 965,
          696, 105, 14, 60, 1325, 88, 1143, 77, 32, 43, 544, 71, 89, 580, 147, 1041, 1314, 78, 790, 1010, 708, 886,
          1104, 564, 1011, 644, 531, 726, 1098, 900, 1322, 1116, 225, 610, 1005, 1308, 148, 920, 956, 1343, 668, 383,
          342, 1004, 1230, 18, 1197, 753, 627, 1111, 441, 625, 839, 1031, 207, 335, 596, 697, 576, 1078, 990, 322, 85,
          986, 279, 996, 434, 515, 66, 28, 1132, 326, 257, 313, 918, 56, 226, 1283, 1280, 286, 390, 977, 836, 540, 1240,
          220, 1172, 856, 1214, 760, 460, 814, 924, 59, 713, 868, 914, 919, 587, 1113, 1029, 1234, 703, 1018, 397, 1366,
          656, 284, 1095, 1301, 1318, 260, 1295, 536, 459, 879, 1043, 1142, 488, 784, 44, 73, 1358, 756, 1252, 190, 985,
          620, 111, 1315, 980, 626, 1188, 394, 1286, 338, 848, 39, 734, 1225, 174, 1244, 9, 1134, 249, 648, 46, 1324, 1135,
          157, 851, 778, 915, 409, 1179, 834, 654, 796, 962, 1028, 1141, 1282, 191, 1259, 25, 910, 994, 1261, 1212, 746,
          1127, 931, 558, 1122, 976, 107, 698, 146, 1144, 548, 906, 19, 514, 628, 100, 185, 1181, 1152, 537, 1070, 829,
          517, 635, 444, 368, 181, 458, 449, 761, 525, 1291, 70, 532, 538, 84, 600, 740, 204, 1298, 138, 1293, 1191, 692,
          1054, 933, 130, 1081, 1048, 958, 94, 1306, 1323, 341, 893, 318, 835, 96, 1222, 828, 1149, 301, 1245, 1255, 592,
          1231, 1176, 622, 273, 1137, 1139, 125, 785, 1123, 704, 20, 608, 1313, 673, 921, 327, 347, 61, 7, 482, 1328, 1131,
          87, 1155, 310, 1042, 650, 646, 852, 194, 1027, 263, 1085, 1159, 1221, 551, 1329, 392, 417, 738, 897, 119, 1151,
          904, 349, 722, 629, 95, 388, 1053, 935, 973, 880, 423, 776, 1115, 542, 485, 106, 617, 1348, 660, 498, 1105, 942,
          647, 452, 982, 272, 307, 122, 529, 799, 812, 577, 1284, 786, 491, 774, 612, 1304, 83, 905, 1336, 206, 334, 788,
          24, 1272, 672, 411, 881, 1034, 1195, 1080, 742, 1290, 579, 1312, 963, 477, 239, 1248, 1274, 754, 772, 1183, 787,
          1341, 1013, 535, 894, 783, 941, 702, 903, 534, 991, 1056, 142, 736, 916, 492, 791, 1326, 136, 1320, 806, 949, 1074,
          1096, 864, 117, 69, 237, 64, 15, 1192, 585, 1264, 356, 516, 483), ]

### Planilha para verificação com o Rayyan
M2 <- select(M, TI)

### SALVANDO NO FORMATO CSV
write.csv2(M, "planilha_referencias_bibliometrix_final786.csv")

### SALVAR NO FORMATO R E EXPORTAR PARA O BIBLIOMETRIX
saveRDS(M, file = "bibliometrix_data_bioinfo_786.rds")

### ABRINDO O BIBLIOSHINY
biblioshiny()

